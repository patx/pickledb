<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>pickleDB · Lightweight Key-Value Store for Python</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    :root {
      --bg: #fafafa;
      --bg-card: #ffffff;
      --border: #e5e7eb;
      --text: #111827;
      --muted: #6b7280;
      --accent: #2563eb;
      --code-bg: #111827;
      --code-fg: #e5e7eb;
    }

    * { box-sizing: border-box; }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      line-height: 1.6;
      margin: 0;
      padding: 2rem 1rem 3rem;
      max-width: 900px;
      margin-inline: auto;
      background: var(--bg);
      color: var(--text);
    }

    a {
      color: var(--accent);
      text-decoration: none;
    }
    a:hover {
      text-decoration: underline;
    }

    h1, h2, h3 {
      color: var(--text);
    }

    h1 {
      font-size: 2rem;
      margin: 0 0 0.5rem;
    }

    h2 {
      font-size: 1.35rem;
      margin-top: 2rem;
      border-bottom: 1px solid var(--border);
      padding-bottom: 0.35rem;
    }

    h3 {
      font-size: 1.1rem;
      margin-top: 1.2rem;
    }

    p {
      margin: 0.35rem 0 0.6rem;
    }

    ul {
      padding-left: 1.25rem;
      margin: 0.25rem 0 0.6rem;
    }

    img {
      max-width: 100%;
      height: auto;
    }

    pre {
      background: var(--code-bg);
      color: var(--code-fg);
      padding: 0.9rem 1rem;
      border-radius: 8px;
      overflow: auto;
      font-size: 0.9rem;
      margin: 0.6rem 0 1rem;
    }

    code {
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      background: #f3f4f6;
      padding: 0.1em 0.35em;
      border-radius: 4px;
      font-size: 0.92em;
    }

    pre code {
      background: transparent;
      padding: 0;
    }

    table {
      border-collapse: collapse;
      width: 100%;
      margin: 0.75rem 0 1rem;
      font-size: 0.95rem;
      background: var(--bg-card);
    }

    th, td {
      border: 1px solid var(--border);
      padding: 0.45rem 0.6rem;
      text-align: left;
    }

    thead {
      background: #f3f4f6;
      font-weight: 600;
    }

    tbody tr:nth-child(even) {
      background: #f9fafb;
    }

    .badges {
      display: flex;
      flex-wrap: wrap;
      gap: 0.75rem;
      align-items: center;
      margin-bottom: 1.25rem;
    }

    .muted {
      color: var(--muted);
      font-size: 0.9rem;
    }

    .note {
      font-size: 0.9rem;
      color: var(--muted);
      border-left: 3px solid var(--border);
      padding-left: 0.75rem;
      margin: 0.3rem 0 0.7rem;
    }

    .pill-note {
      display: inline-block;
      font-size: 0.9rem;
      padding: 0.3rem 0.7rem;
      border-radius: 999px;
      background: #eff6ff;
      color: #1d4ed8;
      border: 1px solid #bfdbfe;
      margin: 0.35rem 0 0.75rem;
    }

    .section-intro {
      margin-bottom: 0.4rem;
    }
  </style>
</head>
<body>

  <div class="badges">
    <a href="https://patx.github.io/pickledb">
      <img src="https://patx.github.io/pickledb/logo.png" alt="pickleDB Logo">
    </a>
    <a href="https://pepy.tech/projects/pickledb">
      <img src="https://static.pepy.tech/badge/pickledb" alt="PyPI Downloads">
    </a>
    <a href="https://github.com/patx/pickledb">
      <img src="https://img.shields.io/github/stars/patx/pickledb?style=flat&logo=github" alt="GitHub Stars">
    </a>
  </div>

  <h1>pickleDB</h1>
  <p class="section-intro">
    <code>pickleDB</code> is a lightweight, JSON-backed key-value store for Python, designed for
    <strong>simple APIs</strong>, <strong>fast in-memory operations</strong>, and a
    <strong>unified sync/async interface</strong>. BSD 3-Clause License · © Harrison Erd.
  </p>

  <h2>Quick Start</h2>

  <h3>Install</h3>
  <pre><code class="language-bash">pip install pickledb
</code></pre>

  <h3>Sync Example</h3>
  <pre><code class="language-python">from pickledb import PickleDB

# Bind to a JSON file; no I/O yet
db = PickleDB("data.json").load()  # load from disk into memory (if file exists)

db.set("username", "alice")
db.set("theme", {"color": "blue", "font": "sans-serif"})

print(db.get("username"))  # → "alice"

db.save()  # atomically write in-memory DB back to data.json
</code></pre>

  <h3>Async Example</h3>
  <pre><code class="language-python">import asyncio
from pickledb import PickleDB

async def main():
    db = await PickleDB("data.json").load()

    await db.set("score", 42)
    value = await db.get("score")
    print(value)  # → 42

    await db.save()

asyncio.run(main())
</code></pre>

  <div class="note">
    <strong>Explicit I/O:</strong> the constructor <code>PickleDB("data.json")</code> never touches disk.
    <code>load()</code> and <code>save()</code> are explicit (or handled by context managers).
  </div>

  <h2>Design & Behavior</h2>
  <ul>
    <li><strong>In-memory first:</strong> all data lives in memory while you work; JSON is used only for persistence.</li>
    <li><strong>Method-only API:</strong> no dict syntax. Use <code>set()</code>, <code>get()</code>, <code>remove()</code>, etc.</li>
    <li><strong>Unified sync/async:</strong> every core method works in both worlds via the same name.</li>
    <li><strong>Atomic disk writes:</strong> uses a temp file and <code>os.replace</code> to avoid partial writes.</li>
    <li><strong>No hidden autosave:</strong> nothing is written to disk unless you call <code>save()</code> or exit a context manager cleanly.</li>
    <li><strong>Single file simplicity:</strong> because the database is saved to a single file pickleDB is not thread safe or process safe. If you need this and you want to use the same/similar API check out <a href="https://github.com/patx/mkvdb">mkvDB</a>.</li>
  </ul>

  <h2>Context Managers</h2>

  <h3>Synchronous</h3>
  <pre><code class="language-python">from pickledb import PickleDB

with PickleDB("data.json") as db:
    # On enter: db.load()
    db.set("foo", "bar")
    db.set("hello", "world")
    # On successful exit: db.save()
</code></pre>

  <h3>Asynchronous</h3>
  <pre><code class="language-python">import asyncio
from pickledb import PickleDB

async def main():
    async with PickleDB("data.json") as db:
        # On enter: await db.load()
        await db.set("foo", "bar")
        await db.set("hello", "world")
        # On successful exit: await db.save()

asyncio.run(main())
</code></pre>

  <h2>Core Methods</h2>

  <p class="section-intro">
    These are the only methods you really need to know. Every method works the same in sync and async code;
    just add <code>await</code> when you’re in an async function. All of these methods are part of the <code>PickleDB</code> class.
  </p>

  <table>
    <thead>
      <tr>
        <th>Method</th>
        <th>Sync usage</th>
        <th>Async usage</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><code>load()</code></td>
        <td><code>db.load()</code></td>
        <td><code>await db.load()</code></td>
        <td>Load (or reload) the JSON file into memory. Returns the same <code>PickleDB</code> instance for chaining.</td>
      </tr>
      <tr>
        <td><code>save()</code></td>
        <td><code>db.save()</code></td>
        <td><code>await db.save()</code></td>
        <td>Atomically save the in-memory database back to disk.</td>
      </tr>
      <tr>
        <td><code>set(key, value)</code></td>
        <td><code>db.set(k, v)</code></td>
        <td><code>await db.set(k, v)</code></td>
        <td>Store a value under <code>key</code>. Keys are coerced to <code>str</code>; values must be JSON-serializable.</td>
      </tr>
      <tr>
        <td><code>get(key, default=None)</code></td>
        <td><code>db.get(k, d)</code></td>
        <td><code>await db.get(k, d)</code></td>
        <td>Retrieve the stored value, or <code>default</code> if the key doesn’t exist.</td>
      </tr>
      <tr>
        <td><code>remove(key)</code></td>
        <td><code>db.remove(k)</code></td>
        <td><code>await db.remove(k)</code></td>
        <td>Delete a key. Returns <code>True</code> if it existed and was removed.</td>
      </tr>
      <tr>
        <td><code>all()</code></td>
        <td><code>db.all()</code></td>
        <td><code>await db.all()</code></td>
        <td>Return a list of all keys in the in-memory database.</td>
      </tr>
      <tr>
        <td><code>purge()</code></td>
        <td><code>db.purge()</code></td>
        <td><code>await db.purge()</code></td>
        <td>Clear the in-memory database. Returns <code>True</code>.</td>
      </tr>
    </tbody>
  </table>

  <p class="note">
    pickleDB is intentionally <strong>method-based only</strong>. Dict-style access like
    <code>db["key"]</code> or <code>db["key"] = value</code> is not supported.
  </p>

  <h2>Common Patterns</h2>

  <h3>Storing Complex Data</h3>
  <pre><code class="language-python"># Store a dictionary
db.set("user", {"name": "Alice", "age": 30})

# Update it
user = db.get("user")
user["age"] += 1
db.set("user", user)

print(db.get("user"))
# {'name': 'Alice', 'age': 31}
</code></pre>

  <h3>Lists / Simple Queues</h3>
  <pre><code class="language-python">db.set("tasks", ["write", "test", "deploy"])

tasks = db.get("tasks", [])
tasks.append("celebrate")
db.set("tasks", tasks)

print(db.get("tasks"))
# ['write', 'test', 'deploy', 'celebrate']
</code></pre>

  <h3>Namespace Keys</h3>
  <pre><code class="language-python">db.set("user:1", {"name": "Alice"})
db.set("user:2", {"name": "Bob"})

def keys_with_prefix(db, prefix):
    return [k for k in db.all() if k.startswith(prefix)]

print(keys_with_prefix(db, "user:"))
# ['user:1', 'user:2']
</code></pre>

  <h3>Basic TTL Pattern (App-Level)</h3>
  <pre><code class="language-python">import time

def set_with_ttl(db, key, value, ttl_seconds):
    db.set(key, {
        "value": value,
        "expires_at": time.time() + ttl_seconds,
    })

def get_if_fresh(db, key):
    data = db.get(key)
    if not data:
        return None
    if time.time() &lt; data.get("expires_at", 0):
        return data["value"]
    db.remove(key)
    return None

set_with_ttl(db, "session", "active", ttl_seconds=5)
time.sleep(3)
print(get_if_fresh(db, "session"))  # 'active'
time.sleep(3)
print(get_if_fresh(db, "session"))  # None
</code></pre>

  <h2>Performance Snapshot</h2>

  <p class="section-intro">
    Example timings loading, reading, and saving large JSON payloads using async mode on a Dell XPS 9350, Ubuntu 24.04:
  </p>

  <table>
    <thead>
      <tr>
        <th>Entries</th>
        <th>Load (into memory)</th>
        <th>Bulk read</th>
        <th>Save (to disk)</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><strong>1M</strong></td>
        <td>0.68 s</td>
        <td>0.64 s</td>
        <td>0.03 s</td>
      </tr>
      <tr>
        <td><strong>10M</strong></td>
        <td>7.48 s</td>
        <td>7.27 s</td>
        <td>0.22 s</td>
      </tr>
      <tr>
        <td><strong>50M</strong></td>
        <td>43.36 s</td>
        <td>36.53 s</td>
        <td>1.09 s</td>
      </tr>
    </tbody>
  </table>

  <p class="muted">
    Full benchmark script: <a href="https://gist.github.com/patx/025ed3a10482459f35c738228ebd0721">available here</a>.
  </p>

  <h2>When Not to Use pickleDB</h2>
  <ul>
    <li>You need multi-process or multi-host concurrency.</li>
    <li>ASGI web servers or frameworks. <small>unless your using a single worker ;)</small></li>
    <li>Your dataset is too large to comfortably fit in memory.</li>
    <li>You need rich querying, indexing, or joins.</li>
  </ul>
  <p class="muted">
    In those cases, consider Redis, SQLite, PostgreSQL, MongoDB, or <a href="https://github.com/patx/mkvdb">mkvDB</a>.
  </p>

  <p class="muted">
    Issues, questions, or ideas? Open an issue on
    <a href="https://github.com/patx/pickledb/issues">GitHub</a>.
  </p>

    <div class="github-banner">
        <a href="https://github.com/patx/pickledb">
            <img style="position: fixed; top: 0; right: 0; border: 0;" src="https://github.blog/wp-content/uploads/2008/12/forkme_right_green_007200.png" alt="Fork me on GitHub">
        </a>
    </div>
    
</body>
</html>

